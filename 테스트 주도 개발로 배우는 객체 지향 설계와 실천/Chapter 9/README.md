# 🌈 Chapter 9: 경매 스나이퍼 개발 의뢰

## 📚 맨 처음부터 시작하기

> 온라인 경매를 감시하다가 가격이 매매 지시 지정 가격에 도달하거나 경매가 종료되기 전까지 가격에 변화가 생길 때마다 약간씩 더 높게 자동으로 입찰을 대행하는 프로그램을 의뢰

## 📚 경매와의 상호 작용

### 🎈 경매 프로토콜
- 입찰자와 경매장의 메시지 프로토콜은 단순한데, 입찰자는 다음과 같은 명령을 보낸다.
  1. Join
    - 입찰자가 경매에 참여한다. XMPP 메시지를 보낸 사람은 입찰자를 나타내고, 채팅 세션의 이름은 품목을 나타낸다.
  2. Bid
    - 입찰자가 경매에 입찰가를 보낸다.
- 경매에서는 다음과 같은 이벤트를 보낸다.
  1. Price
    - 경매에서는 현재 수락된 가격을 보고한다. 경매에서는 이 이벤트를 입찰자가 경매에 참여할 때 입찰자에게, 그리고 새로운 입찰이 수락될 때마다 모든 입찰자에게 전달한다.
  2. Close
    - 경매가 종료됐음을 알린다. 마지막 가격 이벤트를 제시한 입찰자가 해당 경매를 낙찰받는다.

### 🎈 XMPP 메시지
- 메시지 형식은 몇 가지 이름과 값으로만 구성돼 있고, 키/값 쌍으로 단 한 줄로 직렬화된다. 각 줄은 프로토콜 버전 번호로 시작한다. 메시지 형태는 다음과 같다.

```
SOLVersion: 1.1; Command: JOIN;
SOLVersion: 1.1; Event: PRICE; CurrentPrice: 192; Increment: 7; Bidder: Someone
else;
SOLVersion: 1.1; Command: BID; Price: 199;
SOLVersion: 1.1; Event: CLOSE;
```

- 온라인 상에서는 로그인 이름을 이용해 판매할 각 품목을 식별하므로 식별자가 `12793`인 품목을 상대로 입찰하기 위해 클라이언트는 서버의 `auction-12793`라는 *사용자*와 채팅을 시작할 것이다.

## 📚 안전하게 진행하기
- 점진적인 개발의 핵심 기법은 한 번에 만들 수 있는 만큼에 해당하는 기능을 쪼개는 방법을 익히는 것이다. 각 조각은 중요하게 다뤄야 하고 팀이 언제 기능 개발이 완료됐는지 판단할 수 있을 만큼 구체적이어야 하며, 한 개념에 집중하고 신속히 달성할 수 있을 정도로 작아야 한다.
- 작업을 작고, 응집력 있는 덩어리로 나누면 개발 위험을 관리하는 데도 도움이 된다. (구체적이고 주기적인 피드백)
- 스나이퍼 애프리케이션에선 첫 번째 단계는 만들 수 있는 가장 작은 기능에 해당하는 것으로 바로 동작하는 골격이다. 여기서 골격은 스윙, XMPP, 애플리케이션에 이르는 최단 경로를 지나며, 이러한 구성 요소의 짜임새를 보여주기에 충분하다.

> - **단일 품목: 경매 참여, 입찰하지 못한 상태로 낙찰 실패**   
> 핵심 기반 구조에서는 이 경우로 구현을 시작한다.   
> - **단일 품목: 경매 참여, 입찰, 낙찰 실패**   
> 기본 연결에 입찰을 추가한다.   
> - **단일 품목: 경매 참여, 입찰, 낙찰**   
> 누가 낙찰 메시지를 보냈는지 판단한다.
> - **가격 상세 표시**   
> 사용자 인터페이스를 채우기 시작한다.   
> - **여러 품목**   
> 동일한 애플리케이션 내에서 여러 품목의 입찰 기능을 지원한다.   
> - **사용자 인터페이스를 통해 품목을 추가**   
> 사용자 인터페이스를 통해 입력 기능을 구현한다.   
> - **매매 지시 지정 가격에서 입찰을 중단**   
> 스나이퍼 알고리즘에 좀 더 지능적인 요소를 가미한다.

## 📚 이건 진짜가 아니야
- 여태까지는 지면상 제약은 그대로 둔 채 실제 프로젝트가 어떻게 돌아가는지 감을 보이고자 프로세스와 설계의 최단 경로를 취했다. 다음과 같은 사항에 유의한다.
  - 이것은 실제 아키텍처가 아니다. 여기서 설명하는 핵심 기법은 기반 아키텍처와 상관없이 적용 가능한 것들이다.
  - 이것은 애자일 계획하기(Agile Planning)가 아니다.
  - 이것은 현실적인 사용성 설계가 아니다.
